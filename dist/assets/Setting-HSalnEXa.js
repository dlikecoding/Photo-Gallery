import{t as b,i as m,a as w,l as J,d as x,e as i,k as T,b as we,o as ye,c as Ie,h as ke,j as _e,n as K,s as Be,m as Ce,f as Pe,p as Te}from"./index-BvSQAnfI.js";import{A as Ae,R as Le}from"./svgIcons-CL4uA8j0.js";import{g as Fe}from"./fetching-CJXmvtht.js";import{c as D}from"./helper-CM3Kw7rw.js";import{s as e}from"./Setting.module-DgUIRGu_.js";import{H as Re}from"./Header-9gxCup_c.js";var Me=b("<span> free"),Oe=b("<div><div><div>Server Storage</div><div> of <!> used</div></div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><div></div><span>Photos</span></div><div><div></div><span>Live Photos</span></div><div><div></div><span>Videos</span></div><div><div></div><span>Other</span></div><div><div></div><span>Free");function Ee(a){const v=()=>a.spaceInfo,u=()=>a.storageInfo;return(()=>{var c=Oe(),s=c.firstChild,o=s.firstChild,d=o.nextSibling,n=d.firstChild,l=n.nextSibling;l.nextSibling;var f=s.nextSibling,h=f.firstChild,S=h.nextSibling,$=S.nextSibling,g=$.nextSibling,C=g.nextSibling,y=f.nextSibling,I=y.firstChild,k=I.firstChild,B=k.nextSibling,_=I.nextSibling,r=_.firstChild,N=r.nextSibling,A=_.nextSibling,F=A.firstChild,j=F.nextSibling,L=A.nextSibling,R=L.firstChild,W=R.nextSibling,M=L.nextSibling,O=M.firstChild,z=O.nextSibling;return m(d,()=>u().used,n),m(d,()=>u().total,l),m(C,w(J,{get when(){return v().free>5},get children(){var t=Me(),P=t.firstChild;return m(t,()=>u().freeSpace,P),x(()=>i(t,e.storageLabel)),t}})),x(t=>{var P=e.storageContainer,E=e.storageHeaderRow,q=e.storageTitle,H=e.storageSubtitle,U=e.spaces,Q=`${e.storageSegment} ${e.segmentPhotos}`,X=String(v().photo||0),Y=`${e.storageSegment} ${e.segmentLives}`,Z=String(v().live||0),p=`${e.storageSegment} ${e.segmentVideos}`,ee=String(v().video||0),te=`${e.storageSegment} ${e.segmentOthers}`,ie=String(v().other||0),ne=`${e.storageSegment} ${e.segmentFree}`,re=String(v().free||0),oe=e.legend,le=e.legendItem,ae=`${e.legendColor} ${e.legendColorPhotos}`,de=e.legendLabel,se=e.legendItem,ve=`${e.legendColor} ${e.legendColorLives}`,ge=e.legendLabel,ce=e.legendItem,ue=`${e.legendColor} ${e.legendColorVideos}`,fe=e.legendLabel,me=e.legendItem,he=`${e.legendColor} ${e.legendColorOthers}`,Se=e.legendLabel,be=e.legendItem,$e=`${e.legendColor} ${e.legendColorFree}`,xe=e.legendLabel;return P!==t.e&&i(c,t.e=P),E!==t.t&&i(s,t.t=E),q!==t.a&&i(o,t.a=q),H!==t.o&&i(d,t.o=H),U!==t.i&&i(f,t.i=U),Q!==t.n&&i(h,t.n=Q),X!==t.s&&T(h,"flex-grow",t.s=X),Y!==t.h&&i(S,t.h=Y),Z!==t.r&&T(S,"flex-grow",t.r=Z),p!==t.d&&i($,t.d=p),ee!==t.l&&T($,"flex-grow",t.l=ee),te!==t.u&&i(g,t.u=te),ie!==t.c&&T(g,"flex-grow",t.c=ie),ne!==t.w&&i(C,t.w=ne),re!==t.m&&T(C,"flex-grow",t.m=re),oe!==t.f&&i(y,t.f=oe),le!==t.y&&i(I,t.y=le),ae!==t.g&&i(k,t.g=ae),de!==t.p&&i(B,t.p=de),se!==t.b&&i(_,t.b=se),ve!==t.T&&i(r,t.T=ve),ge!==t.A&&i(N,t.A=ge),ce!==t.O&&i(A,t.O=ce),ue!==t.I&&i(F,t.I=ue),fe!==t.S&&i(j,t.S=fe),me!==t.W&&i(L,t.W=me),he!==t.C&&i(R,t.C=he),Se!==t.B&&i(W,t.B=Se),be!==t.v&&i(M,t.v=be),$e!==t.k&&i(O,t.k=$e),xe!==t.x&&i(z,t.x=xe),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0}),c})()}var qe=b("<div><div><div>Client Storage</div><div> of <!> used</div></div><div><span></span><span></span></div><div><div><div></div><span>Used</span></div><div><div></div><span>Free");function He(){const[a,v]=we({quota:0,usage:0});async function u(){const s=await navigator.storage.estimate()||{};v({quota:s.quota||0,usage:s.usage||0})}ye(()=>{u()});const c=Ie(()=>{const{quota:s,usage:o}=a();if(!s)return 0;const d=o/s*100;return Math.min(Math.max(d,0),100)});return(()=>{var s=qe(),o=s.firstChild,d=o.firstChild,n=d.nextSibling,l=n.firstChild,f=l.nextSibling;f.nextSibling;var h=o.nextSibling,S=h.firstChild,$=S.nextSibling,g=h.nextSibling,C=g.firstChild,y=C.firstChild,I=y.nextSibling,k=C.nextSibling,B=k.firstChild,_=B.nextSibling;return m(n,()=>D(a().usage),l),m(n,()=>D(a().quota),f),x(r=>{var N=e.storageContainer,A=e.storageHeaderRow,F=e.storageTitle,j=e.storageSubtitle,L=e.spaces,R=`${e.storageSegment} ${e.segmentOthers}`,W=String(c()),M=`${e.storageSegment} ${e.segmentFree}`,O=String(100-c()),z=e.legend,t=e.legendItem,P=`${e.legendColor} ${e.legendColorOthers}`,E=e.legendLabel,q=e.legendItem,H=`${e.legendColor} ${e.legendColorFree}`,U=e.legendLabel;return N!==r.e&&i(s,r.e=N),A!==r.t&&i(o,r.t=A),F!==r.a&&i(d,r.a=F),j!==r.o&&i(n,r.o=j),L!==r.i&&i(h,r.i=L),R!==r.n&&i(S,r.n=R),W!==r.s&&T(S,"flex-grow",r.s=W),M!==r.h&&i($,r.h=M),O!==r.r&&T($,"flex-grow",r.r=O),z!==r.d&&i(g,r.d=z),t!==r.l&&i(C,r.l=t),P!==r.u&&i(y,r.u=P),E!==r.c&&i(I,r.c=E),q!==r.w&&i(k,r.w=q),H!==r.m&&i(B,r.m=H),U!==r.f&&i(_,r.f=U),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0}),s})()}var Ue=b("<button><span>Dashboard"),Ve=b("<div style=display:flex;gap:5px><button>");const De=()=>{const a=ke(),{loggedUser:v}=_e();return(()=>{var u=Ve(),c=u.firstChild;return c.$$click=()=>a("user"),m(c,w(Ae,{})),m(u,w(J,{get when(){return v.roleType==="admin"},get children(){var s=Ue(),o=s.firstChild;return s.$$click=()=>a("admin"),x(d=>{var n=e.accountButton,l=e.accountButtonText;return n!==d.e&&i(s,d.e=n),l!==d.t&&i(o,d.t=l),d},{e:void 0,t:void 0}),s}}),null),x(()=>i(c,e.accountButton)),u})()};K(["click"]);const G={total:0,used:0,free:0,photo:0,live:0,video:0,all:0,other:0},V=(a,v)=>v>0?a/v*100:0,Ne=a=>{if(!a)return G;const v=a.total||0,u=a.used||0,c=a.all||0,s=a.free||0;if(!v)return{...G,total:v,used:u,all:c};const o=V(a.photo||0,v),d=V(a.live||0,v),n=V(a.video||0,v),l=Math.max(u-c,0),f=Math.max(s,0),h=V(l,v),S=V(f,v);return{total:v,used:u,all:c,free:S,photo:o,live:d,video:n,other:h}};var je=b('<div style=display:inline-flex;justify-content:space-between;align-items:center><div><div><p></p></div></div><button style="background-color:rgba(137, 0, 32, 0.9)">Sign out'),We=b("<img src=/Thumbnails/2025/December/zv28ofuav.webp>"),ze=b("<p>"),Ge=b("<p>Premium Â· 2 TB");function Je(){const{loggedUser:a}=_e(),v=ke();return(()=>{var u=je(),c=u.firstChild,s=c.firstChild,o=s.firstChild,d=c.nextSibling;return m(c,(()=>{var n=We();return x(l=>{var f=e.userAvatar,h=a.status;return f!==l.e&&i(n,l.e=f),h!==l.t&&Be(n,"alt",l.t=h),l},{e:void 0,t:void 0}),n})(),s),m(o,()=>a.userName||"User"),m(s,(()=>{var n=Ce(()=>!!a.userEmail);return()=>n()&&(()=>{var l=ze();return m(l,()=>a.userEmail),x(()=>i(l,e.userEmail)),l})()})(),null),m(s,(()=>{var n=Ce(()=>!!a.roleType);return()=>n()&&(()=>{var l=Ge();return x(()=>i(l,e.userPlan)),l})()})(),null),d.$$click=async()=>{const n=await fetch("api/v1/user/logout");n.ok||console.warn(n),v("/login")},x(n=>{var l=e.storageContainer,f=e.userInfoRow,h=e.userTextContainer,S=e.userName,$=e.tagPill;return l!==n.e&&i(u,n.e=l),f!==n.t&&i(c,n.t=f),h!==n.a&&i(s,n.a=h),S!==n.o&&i(o,n.o=S),$!==n.i&&i(d,n.i=$),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),u})()}K(["click"]);var Ke=b("<main><div class=contentStack><section><div>Breakdown</div><div>Per-folder, per-device, and per-type details coming soon.</div></section><section style=display:flex;justify-content:space-between;align-items:center><span>App Version</span><span>"),Qe=b("<h1>Server Info"),Xe=b("<p>Server, clients, and account details"),Ye=b("<div>"),Ze=b("<div><button class=iconButton type=button style=margin-right:8px>");const ot=()=>{const[a,{refetch:v}]=Pe(async()=>{const o=await Fe();return Ne(o)}),[u,c]=we(!1),s=Ie(()=>{const o=a();if(!o)return{used:"0 B",total:"0 B",freeSpace:"0 B"};const d=Math.max(o.total-o.used,0);return{used:D(o.used),total:D(o.total),freeSpace:D(d)}});return ye(()=>{requestAnimationFrame(()=>c(!0))}),[w(Re,{get left(){return[Qe(),Xe()]},get right(){return(()=>{var o=Ze(),d=o.firstChild;return Te(d,"click",v,!0),m(d,w(J,{get when(){return a.loading},get fallback(){return w(Le,{})},get children(){var n=Ye();return x(()=>i(n,e.spinner)),n}})),m(o,w(De,{}),null),x(n=>{var l=e.headerActions,f=a.loading;return l!==n.e&&i(o,n.e=l),f!==n.t&&(d.disabled=n.t=f),n},{e:void 0,t:void 0}),o})()}}),(()=>{var o=Ke(),d=o.firstChild,n=d.firstChild,l=n.firstChild,f=l.nextSibling,h=n.nextSibling,S=h.firstChild,$=S.nextSibling;return m(d,w(Je,{}),n),m(d,w(Ee,{get spaceInfo(){return a()??G},get storageInfo(){return s()}}),n),m(d,w(He,{}),n),m($,"0.0.1"),x(g=>{var C=`mainHomePage paddingHeader pageTransition ${u()?"pageEnter":""}`,y=e.breakdownCard,I=e.breakdownTitle,k=e.breakdownBody,B=e.breakdownCard,_=e.breakdownTitle,r=e.breakdownBody;return C!==g.e&&i(o,g.e=C),y!==g.t&&i(n,g.t=y),I!==g.a&&i(l,g.a=I),k!==g.o&&i(f,g.o=k),B!==g.i&&i(h,g.i=B),_!==g.n&&i(S,g.n=_),r!==g.s&&i($,g.s=r),g},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),o})()]};K(["click"]);export{ot as SettingView,ot as default};
